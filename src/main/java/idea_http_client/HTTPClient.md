HTTP Client в IDEA, от студента студентам
===

Очень часто в приложениях, которые работают с фронтендом через REST (чем дальше, тем больше таких приложений) необходимо
протестировать какой-нибудь http-запрос, не имея фронтенд части во время работы.

Например: у меня есть таска, где я должен загрузить файл через сайт, обработать его и положить данные в базу. Проблема в
том, что таска фронта будет сделана после моей. То есть я должен уже сейчас иметь возможность загрузить файл по определенному
адресу, но при этом не могу этого сделать через само приложение, т.к. фронте-енд части еще нет.

В таком случае нам поможет встроенный инструмент в IDEA IDE: HTTP Client. (до этого была тулза Test RESTful Web Service в
той же IDEA, но она теперь deprecated).

Используем HTTP Client
---
 
Итак, эта тулза позволяет нам отправить произвольный http-запрос по произвольному адресу с любыми заголовками, телом, любым
методом (get/post/put и другое).

Чтобы начать нажмите alt + insert и выберите Scratch File, далее выберите HTTP Request (он может быть вверху или в середине списка).

Scratch File - это некий файл, который идея создаст в своем внутреннем каталоге и, вероятно, он будет удален после рестарта.
Также такой файл можно добавить в сам проект, как физически существующий файл, но сами понимаете, на код ревью это попасть не должно.

Я приведу файл, который я использую для Spring Framework, учитывающий авторизацию и отправляющий приложенный файл (как если бы вы выбрали его в html-форме)
на определенный эндпоинт:

```http request
POST http://localhost:8080/something/upload
Content-Type: multipart/form-data; boundary=WebAppBoundary
Cookie: JSESSIONID=somelongstringwithvalue

--WebAppBoundary
Content-Disposition: form-data; name="file"; filename="test.xml"
Content-Type: application/xml

< /home/test.xml
--WebAppBoundary--
```

Самое прикольное, что по сути у нас так же выглядит и сам http-запрос в "сыром" виде. То етсь если пользоваться этой штукой, начинает быть куда понятнее,
как работает http. Хотя сам студент, свечку не держал, и, возможно, тут есть какие-то условности.

Что происходит, в общем и целом: мы делаем post-запрос по адресу http://localhost:8080/something/upload, 
где мы говорим, что нужно использовать Cookie с определенным содержимым (см. ниже). При этом запрос будет отправлять
файл (Content-Type: multipart/form-data) и ниже описываем какой файл мы отправляем (думаю, всё очевидно).

Теперь надо нажать "play" (синий треугольник) рядом с этим запросом. Он выполнится и результат будет выведен вам
в консоль, при этом json будет отформатирован, что очень удобно.

Cookie?
---

Скажем прямо - я сам еще ничего ни в чем не понимаю. Но авторизация в Spring, видимо, работает с помощью сессий или аналога
сессий на сервере: вы авторизуетесь по логину-паролю, спринг создает на сервере запись о том, что вы - это вы, а потом
передает в браузер cookie с определенным идентификатором, чтобы связать браузер с сессией на сервере. Возможно это всё вообще
не так, я не знаю, я студент, но выглядит очень похоже.

Поэтому чтобы авторизоваться, необходимо сначала зайти на сайт через браузер (получить cookie с какие-то id), а потом
через f12 найти эту куку и записать ее значение в наш запрос. Тогда при запросе через http client вы как бы "представитесь"
указанным пользователем.

По поводу CSRF ничего не скажу, извините. Надеюсь, было более-менее понятно.